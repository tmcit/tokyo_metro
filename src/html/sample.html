<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>これはアニメーションのテスト</title>
</head>
<body>	
	<form name="form1">
		<select name="sel_railway" onChange="selectBunruiA(this)">
			<option value="">路線を選んでください</option>
		</select>
		<select name="sel_station" width="100px">
			<option value="">駅を選んでください</option>
		</select>
		<input type="button" value="実行" onclick="onDraw()"/>
	</form>

	<!-- ここに選択した路線の駅を並べて表示 -->
	<p>
		<canvas id="canvas1" width="480" height="400" ></canvas>
	</p>
 	<script>
 		var railway = new Array("銀座線", "丸の内線", "日比谷線", "東西線", "有楽町線", "半蔵門線", "南北線", "副都心線");
 		var station = new Array();
 		station["銀座線"] =  new Array("浅草", "田原町", "稲荷町", "上野", "上野広小路", "末広町", "神田", "三越前", "日本橋", "京橋", "銀座", "新橋", "溜池山王", "赤坂見附", "青山一丁目", "外苑前", "表参道", "渋谷");
 		station["丸の内線"] = new Array();
 		station["日比谷線"] = new Array();
 		station["東西線"] = new Array();
 		station["有楽町線"] = new Array();
 		station["半蔵門線"] = new Array();
 		station["南北線"] = new Array();
 		station["副都心線"] = new Array();


 		createSelection(form1.elements["sel_railway"],"駅を選んでください", railway, railway);
 		////////////////////////////////////////////////////
    	//
    	// 選択ボックスに選択肢を追加する関数
    	//	引数: ( selectオブジェクト, value値, text値)
    	function addSelOption( selObj, myValue, myText )
    	{
        	selObj.length++;
        	selObj.options[ selObj.length - 1].value = myValue ;
        	selObj.options[ selObj.length - 1].text  = myText;
 
    	}
    	/////////////////////////////////////////////////////
    	//
    	//	選択リストを作る関数 
    	//	引数: ( selectオブジェクト, 見出し, value値配列 , text値配列 )
    	//
    	function createSelection( selObj, midashi, aryValue, aryText )
    	{
        	selObj.length = 0;
       	 	addSelOption( selObj, midashi, midashi);
        // 初期化
        for( var i=0; i < aryValue.length; i++)
        {
            addSelOption ( selObj , aryValue[i], aryText[i]);
        }
    }
    ///////////////////////////////////////////////////
    //
    // 	分類Aが選択されたときに呼び出される関数
    //
    function selectBunruiA(obj)
    {
        // 選択肢を動的に生成
        createSelection(form1.elements['sel_station'], "駅を選んでください", 
                station[obj.value], station[obj.value]);
 
    }

   	
	var ring ={x:240,y:200,radius:170};
	var block={width:80,height:30};
	function draw(){
   		var n= Math.floor(Math.random()*(names.length-2)+2);
   var s= Math.floor(Math.random()*names.length%n);
   var canvas = document.getElementById('canvas1');
   var context= canvas.getContext('2d');
   context.save();  // おまじない
   context.clearRect(0,0,canvas.width,canvas.height);
   context.beginPath();
   context.arc(ring.x, ring.y, 170, 0, Math.PI*2, false);
   context.lineWidth=4;
   context.strokeStyle = 'blue';
   context.stroke();
   context.lineWidth=1;
   context.strokeStyle = 'black';
   for(var i=0;i<n;++i){
      var nidx= (s+i+names.length)%names.length;
      var r= Math.PI*2/n*i;
      var x= Math.cos(r);
      var y= Math.sin(r);
      context.beginPath();
      context.rect(ring.x-ring.radius*x-block.width/2
                  ,ring.y-ring.radius*y-block.height/2
                  ,block.width,block.height);
      if( nidx==0 ) context.fillStyle = 'lightgreen';
      else          context.fillStyle = 'yellow';
      context.fill();
      context.stroke();
      context.beginPath();
      if( nidx==4 ) context.fillStyle = 'red';  // 文字の色
      else          context.fillStyle = 'black';
      context.font      = "12px arial"; // フォント
      context.textAlign = "center";
      context.fillText(names[nidx]
                      ,ring.x-ring.radius*x
                      ,ring.y-ring.radius*y+4);
      }
   context.restore();  // おまじない
   }
function start(){
   draw();
   setInterval(draw,3000);
   }
try{ // load完了で関数呼び出し
   window.addEventListener("load",start,false);
   }
catch(
 	</script>
</html>